<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>typio-stats test</title>

    <link rel="import" href="../../bower_components/polymer/polymer-element.html">
    <script src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../bower_components/web-component-tester/browser.js"></script>

    <link rel="import" href="../../src/typio-app/typio-drill-creator.html">
  </head>
  <body>

    <test-fixture id="DefaultFixture">
      <template>
        <typio-drill-creator></typio-drill-creator>
      </template>
    </test-fixture>

    <script>
      function countChar(str, c) {
          return (str.match(new RegExp(c, 'g'))||[]).length
      }
    
      suite('typio-drill-creator', function() {

        //
        // Static drill 
        //
        
        test('[static drill] common usage', function() {
          const content = TypioDrillCreator.generateStaticDrill("azerty");
          
          // Should return the same value
          expect(content).to.eql("azerty");
        });
        
        // 
        // Basic drill
        //
        
        test('[basic drill] common usage', function() {
          const len = 10;
          const content = TypioDrillCreator.generateBasicDrill(['a','b'], [1, 2], len);
          
          // Should contains only the given characters 
          expect(countChar(content, 'a') + countChar(content, 'b')).to.eql(len);
        });
        
        test('[basic drill] weights influence the repartition', function() {
          const len = 10;
          const content = TypioDrillCreator.generateBasicDrill(['a','b'], [1, 100], len);
          
          // Should contains only the given characters 
          expect(countChar(content, 'a') < countChar(content, 'b')).to.eql(true, "Due to weights, it should have be a lot more 'b' than 'a'");
        });
        
        //
        // Program drill
        //
        
        test('[program drill] evaluate the program and capture the output', function() {
          const program = `test`;
          const content = TypioDrillCreator.generateProgramDrill(program);
          
          expect(content).to.eql("test");
        });
        
        // TODO
        
        //
        // Regex drill
        //
        
        test('[regex drill] hello world', function() {
          const regexes = {
            'DRILL': /hello world/
          }
          const content = TypioDrillCreator.generateRegexDrill(regexes);
          
          expect(content).to.eql("hello world");
        });
        
        

      });
    </script>


  </body>
</html>
